function Banner(){this.bannerWidth=798,this.bannerGroup=$("#banner-group"),this.index=1,this.leftArrow=$(".left-arrow"),this.rightArrow=$(".right-arrow"),this.bannerUl=$("#banner-ul"),this.liList=this.bannerUl.children("li"),this.bannerCount=this.liList.length,this.pageControl=$(".page-control")}function News(){this.page=2,this.category_id=0,this.loadMoreBtn=$("#load-more"),template.defaults.imports.timeSince=function(n){var e=new Date(n),t=e.getTime(),i=((new Date).getTime()-t)/1e3;return i<60?"刚刚":60<=i&&i<3600?parseInt(i/60)+"分钟前":3600<=i&&i<86400?parseInt(i/3600)+"小时前":86400<=i&&i<2592e3?parseInt(i/86400)+"天前":e.getFullYear()+"/"+e.getMonth()+"/"+e.getDate()+" "+e.getDay()+":"+e.getMinutes()}}Banner.prototype.initBanner=function(){var n=this,e=n.liList.eq(0).clone(),t=n.liList.eq(n.bannerCount-1).clone();n.bannerUl.append(e),n.bannerUl.prepend(t),n.bannerUl.css({width:n.bannerWidth*(n.bannerCount+2),left:-n.bannerWidth})},Banner.prototype.initPageControl=function(){for(var n=this,e=0;e<n.bannerCount;e++){var t=$("<li></li>");n.pageControl.append(t),0===e&&t.addClass("active")}n.pageControl.css({width:12*n.bannerCount+16+16*(n.bannerCount-1)})},Banner.prototype.toggleArrow=function(n){var e=this;n?(e.leftArrow.show(),e.rightArrow.show()):(e.leftArrow.hide(),e.rightArrow.hide())},Banner.prototype.animate=function(){var n=this;n.bannerUl.animate({left:-798*n.index},500);var e=n.index;e=0===e?n.bannerCount-1:e===n.bannerCount+1?0:n.index-1,n.pageControl.children("li").eq(e).addClass("active").siblings().removeClass("active")},Banner.prototype.loop=function(){var n=this;this.timer=setInterval(function(){n.index>=n.bannerCount+1?(n.bannerUl.css({left:-n.bannerWidth}),n.index=2):n.index++,n.animate()},2e3)},Banner.prototype.listenArrowClick=function(){var n=this;n.leftArrow.click(function(){0===n.index?(n.bannerUl.css({left:-n.bannerCount*n.bannerWidth}),n.index=n.bannerCount-1):n.index--,n.animate()}),n.rightArrow.click(function(){n.index===n.bannerCount+1?(n.bannerUl.css({left:-n.bannerWidth}),n.index=2):n.index++,n.animate()})},Banner.prototype.listenBannerHover=function(){var n=this;this.bannerGroup.hover(function(){clearInterval(n.timer),n.toggleArrow(!0)},function(){n.loop(),n.toggleArrow(!1)})},Banner.prototype.listenPageControl=function(){var t=this;t.pageControl.children("li").each(function(n,e){$(e).click(function(){t.index=n,t.animate()})})},Banner.prototype.run=function(){this.initBanner(),this.initPageControl(),this.loop(),this.listenBannerHover(),this.listenArrowClick(),this.listenPageControl()},News.prototype.listenLoadMoreEvent=function(){var i=this;i.loadMoreBtn.click(function(n){n.preventDefault(),$.get({url:"/news/list/",data:{p:i.page,category_id:i.category_id},success:function(n){if(200==n.code){var e=n.data;if(0<e.length){var t=template("news-item",{newses:e});$(".list-inner-group").append(t),i.page+=1}else i.loadMoreBtn.hide()}else window.dataMessage.getMessage(n)},fail:function(n){console.log(n)}})})},News.prototype.listenCategorySwitchEvent=function(){var o=this;$(".list-tab").children().click(function(){var r=$(this),a=r.attr("data-category");o.loadMoreBtn.show(),$.get({url:"/news/list/",data:{category_id:a,p:1},success:function(n){if(200==n.code){var e=n.data,t=template("news-item",{newses:e}),i=$(".list-inner-group");i.empty(),i.append(t),o.page=2,o.category_id=a,r.addClass("active").siblings().removeClass("active")}else window.dataMessage.getMessage(n)}})})},News.prototype.run=function(){this.listenLoadMoreEvent(),this.listenCategorySwitchEvent()},$(function(){(new Banner).run(),(new News).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkJhbm5lciIsInRoaXMiLCJiYW5uZXJXaWR0aCIsImJhbm5lckdyb3VwIiwiJCIsImluZGV4IiwibGVmdEFycm93IiwicmlnaHRBcnJvdyIsImJhbm5lclVsIiwibGlMaXN0IiwiY2hpbGRyZW4iLCJiYW5uZXJDb3VudCIsImxlbmd0aCIsInBhZ2VDb250cm9sIiwiTmV3cyIsInBhZ2UiLCJjYXRlZ29yeV9pZCIsImxvYWRNb3JlQnRuIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJkYXRlVmFsdWUiLCJkYXRlIiwiRGF0ZSIsImRhdGVTdGFtcCIsImdldFRpbWUiLCJ0aW1lU3RhbXAiLCJwYXJzZUludCIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiZ2V0RGF5IiwiZ2V0TWludXRlcyIsInByb3RvdHlwZSIsImluaXRCYW5uZXIiLCJzZWxmIiwiZmlyc3RCYW5uZXIiLCJlcSIsImNsb25lIiwibGFzdEJhbm5lciIsImFwcGVuZCIsInByZXBlbmQiLCJjc3MiLCJ3aWR0aCIsImxlZnQiLCJpbml0UGFnZUNvbnRyb2wiLCJpIiwiY2lyY2xlIiwiYWRkQ2xhc3MiLCJ0b2dnbGVBcnJvdyIsImlzU2hvdyIsInNob3ciLCJoaWRlIiwiYW5pbWF0ZSIsInNpYmxpbmdzIiwicmVtb3ZlQ2xhc3MiLCJsb29wIiwidGltZXIiLCJzZXRJbnRlcnZhbCIsImxpc3RlbkFycm93Q2xpY2siLCJjbGljayIsImxpc3RlbkJhbm5lckhvdmVyIiwiaG92ZXIiLCJjbGVhckludGVydmFsIiwibGlzdGVuUGFnZUNvbnRyb2wiLCJlYWNoIiwib2JqIiwicnVuIiwibGlzdGVuTG9hZE1vcmVFdmVudCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJnZXQiLCJ1cmwiLCJkYXRhIiwicCIsInN1Y2Nlc3MiLCJuZXdzZXMiLCJ0cGwiLCJ3aW5kb3ciLCJkYXRhTWVzc2FnZSIsImdldE1lc3NhZ2UiLCJmYWlsIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwibGlzdGVuQ2F0ZWdvcnlTd2l0Y2hFdmVudCIsImxpIiwiYXR0ciIsInVsIiwiZW1wdHkiXSwibWFwcGluZ3MiOiJBQW1CQSxTQUFTQSxTQUNMQyxLQUFLQyxZQUFjLElBQ25CRCxLQUFLRSxZQUFjQyxFQUFFLGlCQUNyQkgsS0FBS0ksTUFBUSxFQUNiSixLQUFLSyxVQUFZRixFQUFFLGVBQ25CSCxLQUFLTSxXQUFhSCxFQUFFLGdCQUNwQkgsS0FBS08sU0FBV0osRUFBRSxjQUNsQkgsS0FBS1EsT0FBU1IsS0FBS08sU0FBU0UsU0FBUyxNQUNyQ1QsS0FBS1UsWUFBY1YsS0FBS1EsT0FBT0csT0FDL0JYLEtBQUtZLFlBQWNULEVBQUUsaUJBMEh6QixTQUFTVSxPQUNMYixLQUFLYyxLQUFPLEVBQ1pkLEtBQUtlLFlBQWMsRUFDbkJmLEtBQUtnQixZQUFjYixFQUFFLGNBR3JCYyxTQUFTQyxTQUFTQyxRQUFRQyxVQUFZLFNBQVVDLEdBQzVDLElBQUlDLEVBQU8sSUFBSUMsS0FBS0YsR0FDaEJHLEVBQVlGLEVBQUtHLFVBRWpCQyxJQURXLElBQUtILE1BQVFFLFVBQ0FELEdBQWEsSUFFekMsT0FBSUUsRUFBWSxHQUNMLEtBQ2EsSUFBYkEsR0FBbUJBLEVBQVksS0FDeEJDLFNBQVNELEVBQVksSUFDbEIsTUFDRyxNQUFiQSxHQUF3QkEsRUFBWSxNQUMvQkMsU0FBU0QsRUFBWSxNQUNsQixNQUNLLE9BQWJBLEdBQTZCQSxFQUFZLE9BQ3JDQyxTQUFTRCxFQUFZLE9BQ2xCLEtBRUhKLEVBQUtNLGNBS0YsSUFKRk4sRUFBS08sV0FJVyxJQUhsQlAsRUFBS1EsVUFHeUIsSUFGN0JSLEVBQUtTLFNBRXFDLElBRHhDVCxFQUFLVSxjQW5KOUJqQyxPQUFPa0MsVUFBVUMsV0FBYSxXQUMxQixJQUFJQyxFQUFPbkMsS0FDUG9DLEVBQWNELEVBQUszQixPQUFPNkIsR0FBRyxHQUFHQyxRQUNoQ0MsRUFBYUosRUFBSzNCLE9BQU82QixHQUFHRixFQUFLekIs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LEVBQUd0QyxTQUFTLFVBQVVNLFdBQVdDLFlBQVksZUFFN0N1QixPQUFPQyxZQUFZQyxXQUFXUCxTQU9sRDVELEtBQUtvQixVQUFVa0MsSUFBTSxXQUNqQm5FLEtBQUtvRSxzQkFDTHBFLEtBQUtxRiw2QkFHVGxGLEVBQUUsWUFDZSxJQUFJSixRQUNWb0UsT0FFSSxJQUFJdEQsTUFDVnNEIiwiZmlsZSI6ImluZGV4Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIOmdouWQkeWvueixoVxyXG4vLyAxLiDmt7vliqDlsZ7mgKdcclxuLy8g6YCa6L+HdGhpc+WFs+mUruWtl++8jOe7keWumuWxnuaAp++8jOW5tuS4lOaMh+WumuS7lueahOWAvOOAglxyXG4vLyDljp/lnovpk75cclxuLy8gMi4g5re75Yqg5pa55rOVXHJcbi8vIOWcqEJhbm5lci5wcm90b3R5cGXkuIrnu5Hlrprmlrnms5XlsLHlj6/ku6XkuobjgIJcclxuXHJcbi8vIGZ1bmN0aW9uIEJhbm5lcigpIHtcclxuLy8gICAgIC8vIOi/meS4qumHjOmdouWGmeeahOS7o+eggVxyXG4vLyAgICAgLy8g55u45b2T5LqO5pivUHl0aG9u5Lit55qEX19pbml0X1/mlrnms5XnmoTku6PnoIFcclxuLy9cclxuLy8gQmFubmVyLnByb3RvdHlwZS5ncmVldCA9IGZ1bmN0aW9uICh3b3JkKSB7XHJcbi8vICAgICBjb25zb2xlLmxvZygnaGVsbG8gJyx3b3JkKTtcclxuLy8gfTtcclxuLy9cclxuLy8gdmFyIGJhbm5lciA9IG5ldyBCYW5uZXIoKTtcclxuLy8gY29uc29sZS5sb2coYmFubmVyLnBlcnNvbik7XHJcbi8vIGJhbm5lci5ncmVldCgnaGVsbG8gd29ybGQnKTtcclxuXHJcbmZ1bmN0aW9uIEJhbm5lcigpIHtcclxuICAgIHRoaXMuYmFubmVyV2lkdGggPSA3OTg7XHJcbiAgICB0aGlzLmJhbm5lckdyb3VwID0gJChcIiNiYW5uZXItZ3JvdXBcIik7XHJcbiAgICB0aGlzLmluZGV4ID0gMTtcclxuICAgIHRoaXMubGVmdEFycm93ID0gJChcIi5sZWZ0LWFycm93XCIpO1xyXG4gICAgdGhpcy5yaWdodEFycm93ID0gJChcIi5yaWdodC1hcnJvd1wiKTtcclxuICAgIHRoaXMuYmFubmVyVWwgPSAkKFwiI2Jhbm5lci11bFwiKTtcclxuICAgIHRoaXMubGlMaXN0ID0gdGhpcy5iYW5uZXJVbC5jaGlsZHJlbihcImxpXCIpO1xyXG4gICAgdGhpcy5iYW5uZXJDb3VudCA9IHRoaXMubGlMaXN0Lmxlbmd0aDtcclxuICAgIHRoaXMucGFnZUNvbnRyb2wgPSAkKFwiLnBhZ2UtY29udHJvbFwiKTtcclxufVxyXG5cclxuQmFubmVyLnByb3RvdHlwZS5pbml0QmFubmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGZpcnN0QmFubmVyID0gc2VsZi5saUxpc3QuZXEoMCkuY2xvbmUoKTtcclxuICAgIHZhciBsYXN0QmFubmVyID0gc2VsZi5saUxpc3QuZXEoc2VsZi5iYW5uZXJDb3VudCAtIDEpLmNsb25lKCk7XHJcbiAgICBzZWxmLmJhbm5lclVsLmFwcGVuZChmaXJzdEJhbm5lcik7XHJcbiAgICBzZWxmLmJhbm5lclVsLnByZXBlbmQobGFzdEJhbm5lcik7XHJcbiAgICBzZWxmLmJhbm5lclVsLmNzcyh7XCJ3aWR0aFwiOiBzZWxmLmJhbm5lcldpZHRoICogKHNlbGYuYmFubmVyQ291bnQgKyAyKSwgJ2xlZnQnOiAtc2VsZi5iYW5uZXJXaWR0aH0pO1xyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5pbml0UGFnZUNvbnRyb2wgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuYmFubmVyQ291bnQ7IGkrKykge1xyXG4gICAgICAgIHZhciBjaXJjbGUgPSAkKFwiPGxpPjwvbGk+XCIpO1xyXG4gICAgICAgIHNlbGYucGFnZUNvbnRyb2wuYXBwZW5kKGNpcmNsZSk7XHJcbiAgICAgICAgaWYgKGkgPT09IDApIHtcclxuICAgICAgICAgICAgY2lyY2xlLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNlbGYucGFnZUNvbnRyb2wuY3NzKHtcIndpZHRoXCI6IHNlbGYuYmFubmVyQ291bnQgKiAxMiArIDggKiAyICsgMTYgKiAoc2VsZi5iYW5uZXJDb3VudCAtIDEpfSk7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLnRvZ2dsZUFycm93ID0gZnVuY3Rpb24gKGlzU2hvdykge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgaWYgKGlzU2hvdykge1xyXG4gICAgICAgIHNlbGYubGVmdEFycm93LnNob3coKTtcclxuICAgICAgICBzZWxmLnJpZ2h0QXJyb3cuc2hvdygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzZWxmLmxlZnRBcnJvdy5oaWRlKCk7XHJcbiAgICAgICAgc2VsZi5yaWdodEFycm93LmhpZGUoKTtcclxuICAgIH1cclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUuYW5pbWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYuYmFubmVyVWwuYW5pbWF0ZSh7XCJsZWZ0XCI6IC03OTggKiBzZWxmLmluZGV4fSwgNTAwKTtcclxuICAgIHZhciBpbmRleCA9IHNlbGYuaW5kZXg7XHJcbiAgICBpZiAoaW5kZXggPT09IDApIHtcclxuICAgICAgICBpbmRleCA9IHNlbGYuYmFubmVyQ291bnQgLSAxO1xyXG4gICAgfSBlbHNlIGlmIChpbmRleCA9PT0gc2VsZi5iYW5uZXJDb3VudCArIDEpIHtcclxuICAgICAgICBpbmRleCA9IDA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGluZGV4ID0gc2VsZi5pbmRleCAtIDE7XHJcbiAgICB9XHJcbiAgICBzZWxmLnBhZ2VDb250cm9sLmNoaWxkcmVuKCdsaScpLmVxKGluZGV4KS5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUubG9vcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHRoaXMudGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHNlbGYuaW5kZXggPj0gc2VsZi5iYW5uZXJDb3VudCArIDEpIHtcclxuICAgICAgICAgICAgc2VsZi5iYW5uZXJVbC5jc3Moe1wibGVmdFwiOiAtc2VsZi5iYW5uZXJXaWR0aH0pO1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4ID0gMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLmluZGV4Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlbGYuYW5pbWF0ZSgpO1xyXG4gICAgfSwgMjAwMCk7XHJcbn07XHJcblxyXG5cclxuQmFubmVyLnByb3RvdHlwZS5saXN0ZW5BcnJvd0NsaWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5sZWZ0QXJyb3cuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChzZWxmLmluZGV4ID09PSAwKSB7XHJcbiAgICAgICAgICAgIC8vID0977yaMSA9PSAnMSfvvJp0cnVlXHJcbiAgICAgICAgICAgIC8vID09PT0gMSAhPSAnMSdcclxuICAgICAgICAgICAgc2VsZi5iYW5uZXJVbC5jc3Moe1wibGVmdFwiOiAtc2VsZi5iYW5uZXJDb3VudCAqIHNlbGYuYmFubmVyV2lkdGh9KTtcclxuICAgICAgICAgICAgc2VsZi5pbmRleCA9IHNlbGYuYmFubmVyQ291bnQgLSAxO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5kZXgtLTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5hbmltYXRlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzZWxmLnJpZ2h0QXJyb3cuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChzZWxmLmluZGV4ID09PSBzZWxmLmJhbm5lckNvdW50ICsgMSkge1xyXG4gICAgICAgICAgICBzZWxmLmJhbm5lclVsLmNzcyh7XCJsZWZ0XCI6IC1zZWxmLmJhbm5lcldpZHRofSk7XHJcbiAgICAgICAgICAgIHNlbGYuaW5kZXggPSAyO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5kZXgrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5hbmltYXRlKCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUubGlzdGVuQmFubmVySG92ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB0aGlzLmJhbm5lckdyb3VwLmhvdmVyKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyDnrKzkuIDkuKrlh73mlbDmmK/vvIzmiorpvKDmoIfnp7vliqjliLBiYW5uZXLkuIrkvJrmiafooYznmoTlh73mlbBcclxuICAgICAgICBjbGVhckludGVydmFsKHNlbGYudGltZXIpO1xyXG4gICAgICAgIHNlbGYudG9nZ2xlQXJyb3codHJ1ZSk7XHJcbiAgICB9LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8g56ys5LqM5Liq5Ye95pWw5piv77yM5oqK6byg5qCH5LuOYmFubmVy5LiK56e76LWw5Lya5omn6KGM55qE5Ye95pWwXHJcbiAgICAgICAgc2VsZi5sb29wKCk7XHJcbiAgICAgICAgc2VsZi50b2dnbGVBcnJvdyhmYWxzZSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUubGlzdGVuUGFnZUNvbnRyb2wgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLnBhZ2VDb250cm9sLmNoaWxkcmVuKFwibGlcIikuZWFjaChmdW5jdGlvbiAoaW5kZXgsIG9iaikge1xyXG4gICAgICAgICQob2JqKS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgc2VsZi5hbmltYXRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5pbml0QmFubmVyKCk7XHJcbiAgICB0aGlzLmluaXRQYWdlQ29udHJvbCgpO1xyXG4gICAgdGhpcy5sb29wKCk7XHJcbiAgICB0aGlzLmxpc3RlbkJhbm5lckhvdmVyKCk7XHJcbiAgICB0aGlzLmxpc3RlbkFycm93Q2xpY2soKTtcclxuICAgIHRoaXMubGlzdGVuUGFnZUNvbnRyb2woKTtcclxufTtcclxuXHJcblxyXG4vLyDpppbpobXmlrDpl7vliqDovb1cclxuZnVuY3Rpb24gTmV3cygpIHtcclxuICAgIHRoaXMucGFnZSA9IDI7ICAvLyDlvZPliY3ojrflj5bnmoTmmK8gXCLnrKzlh6DpobVcIlxyXG4gICAgdGhpcy5jYXRlZ29yeV9pZCA9IDA7XHJcbiAgICB0aGlzLmxvYWRNb3JlQnRuID0gJChcIiNsb2FkLW1vcmVcIik7XHJcblxyXG4gICAgLy8g5a6a5LmJIGFydC10ZW1wbGF0ZSDmqKHmnb/ov4fmu6TlmahcclxuICAgIHRlbXBsYXRlLmRlZmF1bHRzLmltcG9ydHMudGltZVNpbmNlID0gZnVuY3Rpb24gKGRhdGVWYWx1ZSkge1xyXG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVZhbHVlKTtcclxuICAgICAgICB2YXIgZGF0ZVN0YW1wID0gZGF0ZS5nZXRUaW1lKCk7XHJcbiAgICAgICAgdmFyIG5vd1N0YW1wID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuICAgICAgICB2YXIgdGltZVN0YW1wID0gKG5vd1N0YW1wIC0gZGF0ZVN0YW1wKSAvIDEwMDA7XHJcblxyXG4gICAgICAgIGlmICh0aW1lU3RhbXAgPCA2MCkgeyAgLy8g5LiA5YiG6ZKf5LmL5YaFXHJcbiAgICAgICAgICAgIHJldHVybiBcIuWImuWImlwiXHJcbiAgICAgICAgfSBlbHNlIGlmICh0aW1lU3RhbXAgPj0gNjAgJiYgdGltZVN0YW1wIDwgKDYwICogNjApKSB7ICAvLyAx5YiG6ZKfIH4gMeWwj+aXtumXtFxyXG4gICAgICAgICAgICB2YXIgbWludXRlcyA9IHBhcnNlSW50KHRpbWVTdGFtcCAvIDYwKTtcclxuICAgICAgICAgICAgcmV0dXJuIG1pbnV0ZXMgKyBcIuWIhumSn+WJjVwiXHJcbiAgICAgICAgfSBlbHNlIGlmICh0aW1lU3RhbXAgPj0gNjAgKiA2MCAmJiB0aW1lU3RhbXAgPCAoNjAgKiA2MCAqIDI0KSkgeyAgLy8gMeWwj+aXtiB+IDHlpKnpl7RcclxuICAgICAgICAgICAgdmFyIGhvdXJzID0gcGFyc2VJbnQodGltZVN0YW1wIC8gKDYwICogNjApKTtcclxuICAgICAgICAgICAgcmV0dXJuIGhvdXJzICsgXCLlsI/ml7bliY1cIlxyXG4gICAgICAgIH0gZWxzZSBpZiAodGltZVN0YW1wID49IDYwICogNjAgKiAyNCAmJiB0aW1lU3RhbXAgPCAoNjAgKiA2MCAqIDI0ICogMzApKSB7ICAvLyAx5aSpIH4gMeaciFxyXG4gICAgICAgICAgICB2YXIgZGF5cyA9IHBhcnNlSW50KHRpbWVTdGFtcCAvICg2MCAqIDYwICogMjQpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGRheXMgKyBcIuWkqeWJjVwiO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XHJcbiAgICAgICAgICAgIHZhciBkYXkgPSBkYXRlLmdldERhdGUoKTtcclxuICAgICAgICAgICAgdmFyIGhvdXIgPSBkYXRlLmdldERheSgpO1xyXG4gICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB5ZWFyICsgXCIvXCIgKyBtb250aCArIFwiL1wiICsgZGF5ICsgXCIgXCIgKyBob3VyICsgXCI6XCIgKyBtaW51dGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5OZXdzLnByb3RvdHlwZS5saXN0ZW5Mb2FkTW9yZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgLy8gYWpheCDliqDovb3mm7TlpJrmlrDpl7tcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHNlbGYubG9hZE1vcmVCdG4uY2xpY2soZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAkLmdldCh7XHJcbiAgICAgICAgICAgIHVybDogJy9uZXdzL2xpc3QvJyxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgcDogc2VsZi5wYWdlLFxyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnlfaWQ6IHNlbGYuY2F0ZWdvcnlfaWQsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVsnY29kZSddID09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdzZXMgPSBkYXRhWydkYXRhJ107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld3Nlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cGwgPSB0ZW1wbGF0ZShcIm5ld3MtaXRlbVwiLCB7XCJuZXdzZXNcIjogbmV3c2VzfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1bCA9ICQoXCIubGlzdC1pbm5lci1ncm91cFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdWwuYXBwZW5kKHRwbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGFnZSArPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubG9hZE1vcmVCdG4uaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kYXRhTWVzc2FnZS5nZXRNZXNzYWdlKGRhdGEpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5OZXdzLnByb3RvdHlwZS5saXN0ZW5DYXRlZ29yeVN3aXRjaEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGxpc3RUYWIgPSAkKFwiLmxpc3QtdGFiXCIpO1xyXG4gICAgbGlzdFRhYi5jaGlsZHJlbigpLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbGkgPSAkKHRoaXMpO1xyXG4gICAgICAgIHZhciBjYXRlZ29yeV9pZCA9IGxpLmF0dHIoXCJkYXRhLWNhdGVnb3J5XCIpO1xyXG4gICAgICAgIHZhciBwYWdlID0gMTtcclxuICAgICAgICBzZWxmLmxvYWRNb3JlQnRuLnNob3coKTtcclxuICAgICAgICAkLmdldCh7XHJcbiAgICAgICAgICAgIHVybDogJy9uZXdzL2xpc3QvJyxcclxuICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnlfaWQ6IGNhdGVnb3J5X2lkLFxyXG4gICAgICAgICAgICAgICAgcDogcGFnZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFbJ2NvZGUnXSA9PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3c2VzID0gZGF0YVsnZGF0YSddO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cGwgPSB0ZW1wbGF0ZShcIm5ld3MtaXRlbVwiLCB7XCJuZXdzZXNcIjogbmV3c2VzfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVsID0gJChcIi5saXN0LWlubmVyLWdyb3VwXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHVsLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdWwuYXBwZW5kKHRwbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5wYWdlID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhdGVnb3J5X2lkID0gY2F0ZWdvcnlfaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgbGkuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZGF0YU1lc3NhZ2UuZ2V0TWVzc2FnZShkYXRhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG59O1xyXG5cclxuTmV3cy5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5saXN0ZW5Mb2FkTW9yZUV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlbkNhdGVnb3J5U3dpdGNoRXZlbnQoKTtcclxufTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGJhbm5lciA9IG5ldyBCYW5uZXIoKTtcclxuICAgIGJhbm5lci5ydW4oKTtcclxuXHJcbiAgICB2YXIgbmV3cyA9IG5ldyBOZXdzKCk7XHJcbiAgICBuZXdzLnJ1bigpO1xyXG59KTsiXX0=
